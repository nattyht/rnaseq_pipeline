# Nextflow DESeq2 normalised counts from .bam pipeline

This Nextflow script automates the process of downloading an Ensembl GTF file, generating feature counts from a list of BAM files, and performing DESeq2 analysis in R for generating normalised counts.

## Prerequisites

Before using this script, ensure that you have the following prerequisites installed:

- [Nextflow](https://www.nextflow.io/docs/latest/getstarted.html)
- [R](https://www.r-project.org/)
- [DESeq2 R package](https://bioconductor.org/packages/release/bioc/html/DESeq2.html)
- [featureCounts](http://bioinf.wehi.edu.au/featureCounts/)

## Usage

1. Clone this repository or download the `nextflow_script.nf` file.

2. Run the Nextflow script with the desired parameters. You can specify the following parameters:

   - `ensemblRelease`: Ensembl release version (default: 'release-93').
   - `bamFilesDir`: Directory containing BAM files (default: current directory).
   - `outputDir`: Directory for storing output files (default: current directory).
   - `coldata`: Path to coldata.csv (default: './coldata.csv').
   - `designFormula`: Design formula for DESeq2 analysis (default: '~ condition').

   Example usage:

   ```
   nextflow run nextflow_script.nf --ensemblRelease release-94 --bamFilesDir /path/to/bam/files --outputDir /path/to/output --coldata /path/to/SampleInformation.csv --designFormula '~ condition'
    ```

The script will automatically download the Ensembl GTF file, run featureCounts on the specified BAM files, and perform DESeq2 analysis. The normalized counts will be stored in the specified outputDir.

## Output

The script generates the following output files:

- counts.txt: Feature counts generated by featureCounts.
- norm_counts.csv: Normalized counts from DESeq2 analysis.

## Formatting of coldata.csv
The coldata file (Sample Information) should be a CSV file with one row per sample and columns providing metadata for each sample. DESeq2 requires specific columns for proper analysis. The following columns should be included:

sampleName: A unique identifier for each sample.
condition: The condition or treatment group for each sample (e.g., 'Control', 'Treatment').
Additional metadata columns as needed.
Here is an example coldata file:
```
sampleName,condition
Sample1,Control
Sample2,Control
Sample3,Treatment
Sample4,Treatment
```
Make sure to customize your coldata file according to your experiment's sample information and conditions.
